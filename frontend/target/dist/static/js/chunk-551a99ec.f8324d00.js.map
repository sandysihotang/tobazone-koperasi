{"version":3,"sources":["webpack:///src/components/AuthenticatedUser/Koperasi/KSU/Laporan/KirimLaporan/KirimLaporanKoperasi.vue","webpack:///./src/components/AuthenticatedUser/Koperasi/KSU/Laporan/KirimLaporan/KirimLaporanKoperasi.vue?b017","webpack:///./src/components/AuthenticatedUser/Koperasi/KSU/Laporan/KirimLaporan/KirimLaporanKoperasi.vue?2ee2","webpack:///./src/components/AuthenticatedUser/Koperasi/KSU/Laporan/KirimLaporan/KirimLaporanKoperasi.vue?ae13","webpack:///./src/components/AuthenticatedUser/Koperasi/KSU/Laporan/KirimLaporan/KirimLaporanKoperasi.vue?72c6"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","_v","attrs","on","changeFile","scopedSlots","_u","key","fn","$event","stopPropagation","proxy","model","value","callback","$$v","expression","options","tahunKirim","kirim","pd","_l","htm","domProps","_s","_e","staticRenderFns","component"],"mappings":"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","file":"static/js/chunk-551a99ec.f8324d00.js","sourcesContent":["<template>\r\n  <div class=\"q-pa-md\">\r\n    <div class=\"row\">\r\n      <q-card class=\"full-width\">\r\n        <q-card-section>\r\n          <div class=\"text-h6\">Kirim Laporan Tahunan</div>\r\n        </q-card-section>\r\n        <q-separator/>\r\n        <q-card-section>\r\n          <q-file filled bottom-slots type=\"file\" v-model=\"model\" label=\"Pilih File\" counter\r\n                  @input=\"changeFile\">\r\n            <template v-slot:prepend>\r\n              <q-icon name=\"cloud_upload\" @click.stop/>\r\n            </template>\r\n            <template v-slot:append>\r\n              <q-icon name=\"close\" @click.stop=\"model = null\" class=\"cursor-pointer\"/>\r\n            </template>\r\n            <template v-slot:hint>\r\n              File\r\n            </template>\r\n          </q-file>\r\n          <br>\r\n          <q-select outlined v-model=\"tahunKirim\" :options=\"options\" :dense=\"true\" label=\"Tahun\"\r\n                    :options-dense=\"false\">\r\n            <template v-slot:prepend>\r\n              <q-icon name=\"event\"/>\r\n            </template>\r\n          </q-select>\r\n          <br>\r\n          <q-btn color=\"primary\" icon-right=\"send\" label=\"Kirim Laporan\" @click=\"kirim\"/>\r\n        </q-card-section>\r\n      </q-card>\r\n    </div>\r\n    <br>\r\n    <div class=\"row\" v-if=\"change\">\r\n      <q-card class=\"full-width\">\r\n        <q-card-section v-if=\"pd === true\">\r\n          <embed class=\"full-width full-height\" type=\"application/pdf\" :src=\"`data:application/pdf;base64,${this.nn}#page=1`\"/>\r\n        </q-card-section>\r\n        <q-card-section v-else>\r\n          <div v-for=\"htm in nn\" :key=\"htm\">\r\n            <div v-html=\"htm\"></div>\r\n          </div>\r\n        </q-card-section>\r\n      </q-card>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\n  import XLSX from 'xlsx';\r\n  import mammoth from 'mammoth';\r\n\r\n  export default {\r\n    data() {\r\n      return {\r\n        pd: false,\r\n        file: null,\r\n        nn: [],\r\n        change: false,\r\n        model: null,\r\n        excel: null,\r\n        tahun: [],\r\n        tahunKirim: null,\r\n        options: []\r\n      }\r\n    },\r\n    methods: {\r\n      kirim() {\r\n        if (this.tahunKirim === null || this.excel === null) {\r\n          this.$q.notify({\r\n            type: 'negative',\r\n            message: `Isi Semua Field`\r\n          })\r\n          return\r\n        }\r\n        this.$q.loading.show()\r\n        this.$http.post('/api/kirimlaporankoperasi', this.useFormData(), {\r\n          headers: this.$auth.getHeader()\r\n        })\r\n          .then((res) => {\r\n            const { data } = res\r\n            if (data.errCode === 400) {\r\n              this.$q.notify({\r\n                type: 'negative',\r\n                message: data.err\r\n              })\r\n            } else {\r\n              this.$q.notify({\r\n                type: 'positive',\r\n                message: 'Pengiriman Laporan Berhasil dilakukan'\r\n              })\r\n            }\r\n            this.$q.loading.hide()\r\n          })\r\n          .catch(() => {\r\n            this.$q.notify({\r\n              type: 'negative',\r\n              message: `Terjadi kesalahan refresh (F5)`\r\n            })\r\n            this.$q.loading.hide()\r\n          })\r\n      },\r\n      useFormData() {\r\n        const formData = new FormData();\r\n        formData.append('files', this.excel);\r\n        formData.append('tahun', this.tahunKirim);\r\n        return formData;\r\n      },\r\n      changeFile(e) {\r\n        this.excel = e\r\n        this.pd = false\r\n        if (e === undefined) {\r\n          this.$q.notify({\r\n            type: 'negative',\r\n            message: `File Harus dengan Format xls / xlsx, Docx dan Pdf`\r\n          })\r\n          this.model = null\r\n          return\r\n        }\r\n        this.$q.loading.show();\r\n        if (e.type === 'application/vnd.openxmlformats-officedocument.wordprocessingml.document') {\r\n          const reader = new FileReader();\r\n          reader.onloadend = (event) => {\r\n            const arrayBuffer = reader.result\r\n            mammoth.convertToHtml({ arrayBuffer: arrayBuffer })\r\n              .then((resultObject) => {\r\n                this.nn = []\r\n                this.nn.push(resultObject.value)\r\n              })\r\n            this.change = true\r\n            this.$q.loading.hide()\r\n          }\r\n          reader.readAsArrayBuffer(e);\r\n        } else if (e.type === 'application/pdf') {\r\n          const reader = new FileReader();\r\n          reader.readAsArrayBuffer(e)\r\n          reader.onload = (e) => {\r\n            const table = Buffer.from(e.target.result)\r\n              .toString(\"base64\")\r\n            this.nn = table\r\n            this.pd = true\r\n            this.change = true\r\n            this.$q.loading.hide()\r\n          }\r\n        } else if (e.type === 'application/vnd.ms-excel') {\r\n          const reader = new FileReader();\r\n          reader.readAsArrayBuffer(e)\r\n          reader.onload = (e) => {\r\n            const table = Buffer.from(e.target.result)\r\n              .toString(\"base64\")\r\n            const wb = XLSX.read(table, { type: 'base64' });\r\n            this.nn = []\r\n            for (let i = 0; i < wb.SheetNames.length; i++) {\r\n              const ws = wb.Sheets[wb.SheetNames[i]];\r\n              this.nn.push(XLSX.utils.sheet_to_html(ws, {}))\r\n            }\r\n            this.change = true\r\n            this.$q.loading.hide()\r\n          }\r\n        } else {\r\n          this.$q.notify({\r\n            type: 'negative',\r\n            message: `File Harus dengan Format xls / xlsx, Docx dan Pdf`\r\n          })\r\n          this.model = null\r\n          this.$q.loading.hide()\r\n        }\r\n      },\r\n      base64ToArrayBuffer(base64) {\r\n        const string = window.atob(base64);\r\n        const len = string.length;\r\n        const bytes = new Uint8Array(len);\r\n        for (let i = 0; i < len; i++) {\r\n          bytes[i] = string.charCodeAt(i);\r\n        }\r\n        return bytes.buffer;\r\n      },\r\n      getData() {\r\n        this.$http.get('/api/getonefile', {\r\n          headers: this.$auth.getHeader(),\r\n        })\r\n          .then((res) => {\r\n            const { data } = res\r\n            const wb = XLSX.read(data.file, { type: 'base64' });\r\n            this.nn = []\r\n            for (let i = 0; i < wb.SheetNames.length; i++) {\r\n              const ws = wb.Sheets[wb.SheetNames[i]];\r\n              this.nn.push(XLSX.utils.sheet_to_html(ws, {}))\r\n            }\r\n          })\r\n          .catch(() => {\r\n\r\n          })\r\n      },\r\n      getOptions() {\r\n        const date = new Date()\r\n        const year = date.getFullYear() - 10;\r\n        let t = year\r\n        this.options = []\r\n        while (t < year + 20) {\r\n          this.options.push(t)\r\n          t++\r\n        }\r\n      }\r\n    },\r\n    created() {\r\n      this.getOptions()\r\n    }\r\n  }\r\n</script>\r\n\r\n<style>\r\n  table {\r\n    width: 100%;\r\n    border-collapse: collapse;\r\n  }\r\n\r\n  /* Zebra striping */\r\n  tr:nth-of-type(odd) {\r\n    background: #eee;\r\n  }\r\n\r\n  th {\r\n    background: #333;\r\n    color: white;\r\n    font-weight: bold;\r\n  }\r\n\r\n  td, th {\r\n    padding: 6px;\r\n    border: 1px solid #ccc;\r\n    text-align: left;\r\n  }\r\n</style>\r\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"q-pa-md\"},[_c('div',{staticClass:\"row\"},[_c('q-card',{staticClass:\"full-width\"},[_c('q-card-section',[_c('div',{staticClass:\"text-h6\"},[_vm._v(\"Kirim Laporan Tahunan\")])]),_c('q-separator'),_c('q-card-section',[_c('q-file',{attrs:{\"filled\":\"\",\"bottom-slots\":\"\",\"type\":\"file\",\"label\":\"Pilih File\",\"counter\":\"\"},on:{\"input\":_vm.changeFile},scopedSlots:_vm._u([{key:\"prepend\",fn:function(){return [_c('q-icon',{attrs:{\"name\":\"cloud_upload\"},on:{\"click\":function($event){$event.stopPropagation();}}})]},proxy:true},{key:\"append\",fn:function(){return [_c('q-icon',{staticClass:\"cursor-pointer\",attrs:{\"name\":\"close\"},on:{\"click\":function($event){$event.stopPropagation();_vm.model = null}}})]},proxy:true},{key:\"hint\",fn:function(){return [_vm._v(\" File \")]},proxy:true}]),model:{value:(_vm.model),callback:function ($$v) {_vm.model=$$v},expression:\"model\"}}),_c('br'),_c('q-select',{attrs:{\"outlined\":\"\",\"options\":_vm.options,\"dense\":true,\"label\":\"Tahun\",\"options-dense\":false},scopedSlots:_vm._u([{key:\"prepend\",fn:function(){return [_c('q-icon',{attrs:{\"name\":\"event\"}})]},proxy:true}]),model:{value:(_vm.tahunKirim),callback:function ($$v) {_vm.tahunKirim=$$v},expression:\"tahunKirim\"}}),_c('br'),_c('q-btn',{attrs:{\"color\":\"primary\",\"icon-right\":\"send\",\"label\":\"Kirim Laporan\"},on:{\"click\":_vm.kirim}})],1)],1)],1),_c('br'),(_vm.change)?_c('div',{staticClass:\"row\"},[_c('q-card',{staticClass:\"full-width\"},[(_vm.pd === true)?_c('q-card-section',[_c('embed',{staticClass:\"full-width full-height\",attrs:{\"type\":\"application/pdf\",\"src\":(\"data:application/pdf;base64,\" + (this.nn) + \"#page=1\")}})]):_c('q-card-section',_vm._l((_vm.nn),function(htm){return _c('div',{key:htm},[_c('div',{domProps:{\"innerHTML\":_vm._s(htm)}})])}),0)],1)],1):_vm._e()])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import mod from \"-!../../../../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../../../../node_modules/thread-loader/dist/cjs.js!../../../../../../../node_modules/babel-loader/lib/index.js!../../../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./KirimLaporanKoperasi.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../../../../node_modules/thread-loader/dist/cjs.js!../../../../../../../node_modules/babel-loader/lib/index.js!../../../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./KirimLaporanKoperasi.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./KirimLaporanKoperasi.vue?vue&type=template&id=16ec82b7&\"\nimport script from \"./KirimLaporanKoperasi.vue?vue&type=script&lang=js&\"\nexport * from \"./KirimLaporanKoperasi.vue?vue&type=script&lang=js&\"\nimport style0 from \"./KirimLaporanKoperasi.vue?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","import mod from \"-!../../../../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./KirimLaporanKoperasi.vue?vue&type=style&index=0&lang=css&\"; export default mod; export * from \"-!../../../../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./KirimLaporanKoperasi.vue?vue&type=style&index=0&lang=css&\""],"sourceRoot":""}