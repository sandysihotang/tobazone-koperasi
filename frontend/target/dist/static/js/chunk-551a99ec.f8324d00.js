(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-551a99ec"],{"413a":function(e,t,n){"use strict";(function(e){n("ace4"),n("d3b7"),n("25f0"),n("5cc6"),n("9a8c"),n("a975"),n("735e"),n("c1ac"),n("d139"),n("3a7b"),n("d5d6"),n("82f8"),n("e91f"),n("60bd"),n("5f96"),n("3280"),n("3fcc"),n("ca91"),n("25a1"),n("cd26"),n("3c5d"),n("2954"),n("649e"),n("219c"),n("170b"),n("b39a"),n("72f7");var a=n("1146"),i=n.n(a),o=n("c343"),r=n.n(o);t["a"]={data:function(){return{pd:!1,file:null,nn:[],change:!1,model:null,excel:null,tahun:[],tahunKirim:null,options:[]}},methods:{kirim:function(){var e=this;null!==this.tahunKirim&&null!==this.excel?(this.$q.loading.show(),this.$http.post("/api/kirimlaporankoperasi",this.useFormData(),{headers:this.$auth.getHeader()}).then((function(t){var n=t.data;400===n.errCode?e.$q.notify({type:"negative",message:n.err}):e.$q.notify({type:"positive",message:"Pengiriman Laporan Berhasil dilakukan"}),e.$q.loading.hide()})).catch((function(){e.$q.notify({type:"negative",message:"Terjadi kesalahan refresh (F5)"}),e.$q.loading.hide()}))):this.$q.notify({type:"negative",message:"Isi Semua Field"})},useFormData:function(){var e=new FormData;return e.append("files",this.excel),e.append("tahun",this.tahunKirim),e},changeFile:function(t){var n=this;if(this.excel=t,this.pd=!1,void 0===t)return this.$q.notify({type:"negative",message:"File Harus dengan Format xls / xlsx, Docx dan Pdf"}),void(this.model=null);if(this.$q.loading.show(),"application/vnd.openxmlformats-officedocument.wordprocessingml.document"===t.type){var a=new FileReader;a.onloadend=function(e){var t=a.result;r.a.convertToHtml({arrayBuffer:t}).then((function(e){n.nn=[],n.nn.push(e.value)})),n.change=!0,n.$q.loading.hide()},a.readAsArrayBuffer(t)}else if("application/pdf"===t.type){var o=new FileReader;o.readAsArrayBuffer(t),o.onload=function(t){var a=e.from(t.target.result).toString("base64");n.nn=a,n.pd=!0,n.change=!0,n.$q.loading.hide()}}else if("application/vnd.ms-excel"===t.type){var s=new FileReader;s.readAsArrayBuffer(t),s.onload=function(t){var a=e.from(t.target.result).toString("base64"),o=i.a.read(a,{type:"base64"});n.nn=[];for(var r=0;r<o.SheetNames.length;r++){var s=o.Sheets[o.SheetNames[r]];n.nn.push(i.a.utils.sheet_to_html(s,{}))}n.change=!0,n.$q.loading.hide()}}else this.$q.notify({type:"negative",message:"File Harus dengan Format xls / xlsx, Docx dan Pdf"}),this.model=null,this.$q.loading.hide()},base64ToArrayBuffer:function(e){for(var t=window.atob(e),n=t.length,a=new Uint8Array(n),i=0;i<n;i++)a[i]=t.charCodeAt(i);return a.buffer},getData:function(){var e=this;this.$http.get("/api/getonefile",{headers:this.$auth.getHeader()}).then((function(t){var n=t.data,a=i.a.read(n.file,{type:"base64"});e.nn=[];for(var o=0;o<a.SheetNames.length;o++){var r=a.Sheets[a.SheetNames[o]];e.nn.push(i.a.utils.sheet_to_html(r,{}))}})).catch((function(){}))},getOptions:function(){var e=new Date,t=e.getFullYear()-10,n=t;this.options=[];while(n<t+20)this.options.push(n),n++}},created:function(){this.getOptions()}}}).call(this,n("b639").Buffer)},"7e07":function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"q-pa-md"},[n("div",{staticClass:"row"},[n("q-card",{staticClass:"full-width"},[n("q-card-section",[n("div",{staticClass:"text-h6"},[e._v("Kirim Laporan Tahunan")])]),n("q-separator"),n("q-card-section",[n("q-file",{attrs:{filled:"","bottom-slots":"",type:"file",label:"Pilih File",counter:""},on:{input:e.changeFile},scopedSlots:e._u([{key:"prepend",fn:function(){return[n("q-icon",{attrs:{name:"cloud_upload"},on:{click:function(e){e.stopPropagation()}}})]},proxy:!0},{key:"append",fn:function(){return[n("q-icon",{staticClass:"cursor-pointer",attrs:{name:"close"},on:{click:function(t){t.stopPropagation(),e.model=null}}})]},proxy:!0},{key:"hint",fn:function(){return[e._v(" File ")]},proxy:!0}]),model:{value:e.model,callback:function(t){e.model=t},expression:"model"}}),n("br"),n("q-select",{attrs:{outlined:"",options:e.options,dense:!0,label:"Tahun","options-dense":!1},scopedSlots:e._u([{key:"prepend",fn:function(){return[n("q-icon",{attrs:{name:"event"}})]},proxy:!0}]),model:{value:e.tahunKirim,callback:function(t){e.tahunKirim=t},expression:"tahunKirim"}}),n("br"),n("q-btn",{attrs:{color:"primary","icon-right":"send",label:"Kirim Laporan"},on:{click:e.kirim}})],1)],1)],1),n("br"),e.change?n("div",{staticClass:"row"},[n("q-card",{staticClass:"full-width"},[!0===e.pd?n("q-card-section",[n("embed",{staticClass:"full-width full-height",attrs:{type:"application/pdf",src:"data:application/pdf;base64,"+this.nn+"#page=1"}})]):n("q-card-section",e._l(e.nn,(function(t){return n("div",{key:t},[n("div",{domProps:{innerHTML:e._s(t)}})])})),0)],1)],1):e._e()])},i=[],o=n("413a"),r=o["a"],s=(n("c586"),n("2877")),l=Object(s["a"])(r,a,i,!1,null,null,null);t["default"]=l.exports},c586:function(e,t,n){"use strict";var a=n("ea99"),i=n.n(a);i.a},ea99:function(e,t,n){}}]);
//# sourceMappingURL=chunk-551a99ec.f8324d00.js.map